{% extends 'base.html' %}
{% load static %}
{% block load_js %}
    <script>
        $('#collectsinger').click(self,function () {
            $.ajax({
                url:'{% url 'apis:SingerCollect' singer.singer_mid%}',
                type:'GET',
                success(data){
                    if(data.code==200){
                        if(data.msg.status){
                            $('#collectsinger').html('<i class="glyphicon glyphicon-heart" style="color:rgb(219,88,96);" id="changestatus"></i>关注'+data.fans+'万');
                        }else{
                            $('#collectsinger').html('<i class="glyphicon glyphicon-heart-empty" id="changestatus"></i>关注'+data.fans+'万');
                        }
                    }
                }

            })
        })
    </script>
    <script>
        $('#player').click(function () {
            var tempForm = document.createElement("form");
            tempForm.id = "tempForm1";
            tempForm.method = "post";
            tempForm.action = "{% url 'repo:playerlist' %}";
            tempForm.target = "_blank";
            var hideInput1 = document.createElement("input");
            hideInput1.type = "hidden";
            hideInput1.name='mid';
            hideInput1.value = '{{ singer.singer_mid }}';
            tempForm.appendChild(hideInput1);
            if(document.all){
                tempForm.attachEvent("onsubmit",function(){}); 
            }else{
                var subObj = tempForm.addEventListener("submit",function(){},false);
            }
            document.body.appendChild(tempForm);
            if(document.all){
                tempForm.fireEvent("onsubmit");
            }else{
                tempForm.dispatchEvent(new Event("submit"));
            }
            tempForm.submit();
            document.body.removeChild(tempForm);
        })
    </script>
{% endblock %}
{% block content %}
<section class="vbox" id="bjax-el">
            <section class="scrollable wrapper-lg">
              <div class="row">
                <div class="col-sm-8">
                  <div class="panel wrapper-lg">
                    <div class="row">
                      <div class="col-sm-2">
                        <img src="{{ singer.img }}" class="img-full m-b">
                      </div>
                      <div class="col-sm-7">
                        <h2 class="m-t-none text-black">{{ singer.name }}</h2>
                        <div class="m-b-lg">
                          <a href="javascript:void(0)" id="player" class="btn btn-success">播放歌手歌曲</a> <button class="btn btn-default" id="collectsinger">{% if status %}<i class="glyphicon glyphicon-heart" style="color:rgb(219,88,96);" id="changestatus"></i>{% else %}<i class="glyphicon glyphicon-heart-empty" id="changestatus"></i>{% endif %}关注{{ fans }}万</button>
                        </div>
                        <div>
                          标签: <a href="{% url 'repo:allsinger' %}?category={{ singer.category.id }}" class="badge bg-light">{{ singer.category }}</a>
                        </div>
                      </div>
                    </div>
                    <h4 class="m-t-lg m-b">热门歌曲</h4>
                    <ul class="list-group list-group-lg">
                        {% for item in music %}
                      <li class="list-group-item">
                        <div class="pull-right m-l">
                            <a href="#" class="m-r-sm"><i class="icon-control-play text"></i></a>
                            <a href="javascript:void(0)" class="m-r-sm"><i class="icon-cloud-download"></i></a>
                            <a href="#" class="m-r-sm"><i class="icon-plus"></i></a>
                        </div>
                          <span class="pull-left">{{ forloop.counter }}&nbsp&nbsp&nbsp&nbsp&nbsp</span>
                        <div class="clear text-ellipsis">
                          <a href="{% url 'detail:song' item.id %}"><span>{{ item.name }}</span></a>
                        </div>
                      </li>
                        {% endfor %}
                        <ul class="pagination pagination">
                            {% if music.has_previous %}
                                <li><a href="?page=1">第一页</a></li>
                                <li><a href="?page={{ music.previous_page_number }}"><i class="fa fa-chevron-left"></i></a></li>
                            {% else %}
                                <li><a href="javascript:void(0)" disabled="disabled">第一页</a></li>
                                <li><a href="javascript:void(0)"><i class="fa fa-chevron-left"></i></a></li>
                            {% endif %}
                            {% if music.has_next %}
                                <li><a href="?page={{ music.next_page_number }}"><i class="fa fa-chevron-right"></i></a></li>
                                <li><a href="?page={{ music.paginator.num_pages }}">最后一页</a></li>
                            {% else %}
                                <li><a href="javascript:void(0)"><i class="fa fa-chevron-right"></i></a></li>
                                <li><a href="javascript:void(0)">最后一页</a></li>
                            {% endif %}
                        </ul>
                    </ul>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div class="panel panel-default">
                    <div class="panel-heading">Suggestions</div>
                    <div class="panel-body">
                      <article class="media">
                        <a href="#" class="pull-left thumb-md m-t-xs">
                          <img src="{% static 'images/m18.jpg' %}">
                        </a>
                        <div class="media-body">
                          <a href="#" class="font-semibold">Bootstrap 3: What you need to know</a>
                          <div class="text-xs block m-t-xs"><a href="#">Travel</a> 2 minutes ago</div>
                        </div>
                      </article>
                      <article class="media">
                        <a href="#" class="pull-left thumb-md m-t-xs">
                          <img src="{% static 'images/m19.jpg' %}">
                        </a>
                        <div class="media-body">
                          <a href="#" class="font-semibold">Lorem ipsum dolor sit amet it.</a>
                          <div class="text-xs block m-t-xs"><a href="#">Design</a> 2 hours ago</div>
                        </div>
                      </article>
                      <article class="media">
                        <a href="#" class="pull-left thumb-md m-t-xs">
                          <img src="{% static 'images/m20.jpg' %}">
                        </a>
                        <div class="media-body">
                          <a href="#" class="font-semibold">Sed diam nonummy tincidunt ut laoreet</a>
                          <div class="text-xs block m-t-xs"><a href="#">MFC</a> 1 week ago</div>
                        </div>
                      </article>
                      <article class="media">
                        <a href="#" class="pull-left thumb-md m-t-xs">
                          <img src="{% static 'images/m21.jpg' %}">
                        </a>
                        <div class="media-body">
                          <a href="#" class="font-semibold">Lonummy nibh euismod sed laoreet</a>
                          <div class="text-xs block m-t-xs"><a href="#">MFC</a> 1 week ago</div>
                        </div>
                      </article>
                      <article class="media">
                        <a href="#" class="pull-left thumb-md m-t-xs">
                          <img src="{% static 'images/m22.jpg' %}">
                        </a>
                        <div class="media-body">
                          <a href="#" class="font-semibold">Mibh euismod tincidunt ut laoreet</a>
                          <div class="text-xs block m-t-xs"><a href="#">MFC</a> 1 week ago</div>
                        </div>
                      </article>
                    </div>
                  </div>
                </div>
              </div>
            </section>
          </section>
          <a href="#" class="hide nav-off-screen-block" data-toggle="class:nav-off-screen,open" data-target="#nav,html"></a>
{% endblock %}